:set gcr=n-v-c:blinkon0
:set autowrite
:au FocusLost * silent! wa

" Keybindings
" -----------

" Search
nmap <leader>s  :%s/
vmap <leader>s  :s/

" Split screen
map <leader>v   :vsp<CR>

" Move between screens
map <leader>w   ^Ww
map <leader>=   ^W=
map <leader>j   ^Wj
map <leader>k   ^Wk
nmap <C-j>      <C-w>j
nmap <C-k>      <C-w>k
nmap <C-h>      <C-w>h
nmap <C-l>      <C-w>l

" File tree browser
map \           :NERDTreeToggle<CR>

" File tree browser showing current file - pipe (shift-backslash)
map \|          :NERDTreeFind<CR>

" Open .vimrc file in new tab. Think Command + , [Preferences...] but with Shift.
map <D-<>       :tabedit ~/.vimrc.after<CR>

" Reload .vimrc
map <leader>rv  :source ~/.vimrc.after<CR>

" Undo/redo - Doesn't MacVim already have this?
map <D-z>       :earlier 1<CR>
map <D-Z>       :later 1<CR>

" ctags with rails 2 load path
map <leader>t :!script/runner 'puts $LOAD_PATH.join(" ")' \| xargs /usr/local/bin/ctags -R public/javascripts -f tags<CR>
map <leader>T :!script/runner 'puts $LOAD_PATH.join(" ")' \| xargs rdoc -f tags<CR>

" ctags with rails 3 load path
" map <leader>t :!rails runner 'puts $LOAD_PATH.join(" ")' \| xargs /usr/local/bin/ctags -R public/javascripts -f tags<CR>
" map <leader>T :!rails runner 'puts $LOAD_PATH.join(" ")' \| xargs rdoc -f tags<CR>

" Ack current word
map <leader>a :Ack<CR>

" Auto-indent whole file
nmap <leader>=  gg=G``
map <silent> <F7> gg=G``:echo "Reformatted."<CR>
nnoremap <silent> <Space> :nohlsearch<Bar>:echo<CR>""

" Copy current buffer path relative to root of VIM session to system clipboard
nnoremap <Leader>yp :let @*=expand("%")<cr>:echo "Copied file path to clipboard"<cr>

" Copy current buffer path relative to root of VIM session to system clipboard
nnoremap <Leader>ya :let @*=expand("%:p")<cr>:echo "Copied absolute file path to clipboard"<cr>

if janus#is_plugin_enabled("ctrlp")
  let g:ctrlp_arg_map = 0
  map <D-e> :CtrlPBuffer<CR>
endif

" <leader> r runs vroom on file
" <leader> R runs vroom on nearest example
if janus#is_plugin_enabled("vroom")
  let g:vroom_test_unit_command = 'zeus testrb --no-use-color '
  let g:vroom_use_bundle_exec = 0
endif
